var ZhengJSToNativeHandlerName='%@';var ZhengCallBackSuccessKey='%@';var ZhengCallBackFailKey='%@';var ZhengCallBackCompleteKey='%@';var ZhengJSType=function(){var type={};var typeArr=['String','Object','Number','Array','Undefined','Function','Null','Symbol','Boolean'];for(var i=0;i<typeArr.length;i++){(function(name){type['is'+name]=function(obj){return Object.prototype.toString.call(obj)=='[object '+name+']'}})(typeArr[i])}return type}();var ZhengCallBackMap={};var %@=function(params){if(!ZhengJSType.isString(params)||!params){return}var newParams=JSON.parse(decodeURIComponent(params));if(!ZhengJSType.isObject(newParams)){return}var funcId=newParams.funcId;var res=newParams.data;var alive=newParams.alive;var randomKey='',funcNameKey='';var matchKey=function(key){var matchNumber=funcId.length-key.length;if(matchNumber>=0&&funcId.lastIndexOf(key)==matchNumber){}else{return false}randomKey=funcId.replace(new RegExp(key,'g'),'');funcNameKey=key;return true};var matchRes=matchKey(ZhengCallBackSuccessKey)||matchKey(ZhengCallBackFailKey)||matchKey(ZhengCallBackCompleteKey);if(!matchRes)return;var funcMap=ZhengCallBackMap[randomKey];if(!ZhengJSType.isObject(funcMap))return;var func=funcMap[funcNameKey];if(!ZhengJSType.isFunction(func))return;try{func(res)}catch(error){console.log('CallBack-error');console.log(error)}if(alive)return;if(funcNameKey==ZhengCallBackCompleteKey){ZhengRemoveCallBack(randomKey)}};var ZhengAddCallBack=function(randomKey,funcNameKey,func){var funcMap=ZhengCallBackMap[randomKey];if(!ZhengJSType.isObject(funcMap)){var map={};map[funcNameKey]=func;ZhengCallBackMap[randomKey]=map;return}if(funcMap.hasOwnProperty(funcNameKey))return;funcMap[funcNameKey]=func;ZhengCallBackMap[randomKey]=funcMap};var ZhengRemoveCallBack=function(randomKey){if(!ZhengCallBackMap.hasOwnProperty(randomKey))return;delete ZhengCallBackMap[randomKey]};var ZhengHandleCallBackParams=function(methodName,params){if(!ZhengJSType.isObject(params)){return params}var randomKey='-'+methodName+'-'+(new Date).getTime().toString()+'-'+Math.floor(Math.random()*1e4).toString()+'-';var newParams=params;var funcId='';var success=params.success;if(success&&ZhengJSType.isFunction(success)){funcId=randomKey+ZhengCallBackSuccessKey;ZhengAddCallBack(randomKey,ZhengCallBackSuccessKey,success);newParams[ZhengCallBackSuccessKey]=funcId}var fail=params.fail;if(fail&&ZhengJSType.isFunction(fail)){funcId=randomKey+ZhengCallBackFailKey;ZhengAddCallBack(randomKey,ZhengCallBackFailKey,fail);newParams[ZhengCallBackFailKey]=funcId}var complete=params.complete;if(complete&&ZhengJSType.isFunction(complete)){funcId=randomKey+ZhengCallBackCompleteKey;ZhengAddCallBack(randomKey,ZhengCallBackCompleteKey,complete);newParams[ZhengCallBackCompleteKey]=funcId}return newParams};var ZhengSendParams=function(apiPrefix,methodName,params,sync){var newParams=params;var resArgs=[];if(Object.prototype.toString.call(newParams)==='[object Arguments]'){var argCount=newParams.length;for(var argIdx=0;argIdx<argCount;argIdx++){if(!sync&&argIdx==0){resArgs.push(ZhengHandleCallBackParams(methodName,newParams[argIdx]))}else{resArgs.push(newParams[argIdx])}}}var res={methodName:methodName,apiPrefix:apiPrefix,args:resArgs};return sync?res:JSON.parse(JSON.stringify(res))};var ZhengSendNative=function(params){var handler=window.webkit.messageHandlers[ZhengJSToNativeHandlerName];handler.postMessage(params)};var ZhengSendNativeSync=function(params){var res=prompt(JSON.stringify(params));try{res=JSON.parse(res);return res.data}catch(error){console.log('âŒSendNativeSync--error');console.log(error)}return null};var %@=function(apiPrefix,apiMap){if(!apiPrefix||!ZhengJSType.isString(apiPrefix)||!ZhengJSType.isObject(apiMap)){return{}}var res={};var mapKeys=Object.keys(apiMap);for(var i=0;i<mapKeys.length;i++){(function(name){var config=apiMap[name];var isSync=config.hasOwnProperty('sync')?config.sync:false;res[name]=isSync?function(){return ZhengSendNativeSync(ZhengSendParams(apiPrefix,name,arguments,true))}:function(){ZhengSendNative(ZhengSendParams(apiPrefix,name,arguments,false))}})(mapKeys[i])}return res};